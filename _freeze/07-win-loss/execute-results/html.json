{
  "hash": "3eebf0a2c149f10832c0eae9f176f9eb",
  "result": {
    "engine": "knitr",
    "markdown": "# Win-Loss Models\n\nIn this chapter, we investigate models when you only observe the binary outcome\nof the home team winning the game. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(\"tidyverse\"); theme_set(theme_bw())\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: package 'purrr' was built under R version 4.4.1\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4.9000     ✔ readr     2.1.5     \n✔ forcats   1.0.0          ✔ stringr   1.5.1     \n✔ ggplot2   3.5.1          ✔ tibble    3.2.1     \n✔ lubridate 1.9.3          ✔ tidyr     1.3.1     \n✔ purrr     1.0.4          \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(\"DT\")\nlibrary(\"BradleyTerry2\")\n```\n:::\n\n\nA simple example of margin-of-victory data is this fictitious collection of 4 \nteams that have played 5 games. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nd <- tribble(\n  ~home, ~away, ~home_score, ~away_score, \n      1,     2,          21,           7,\n      2,     3,          13,          14,\n      4,     1,           3,          28,\n      3,     4,          31,           0,\n      1,     3,          42,          10\n) |>\n  mutate(\n    home_win = home_score > away_score # binary indicator of who won\n  )\n```\n:::\n\n\nFor the analysis that follows, \nwe will construct a model matrix $X$ where \n$X_{g,t} = 1$ if team $t$ is the home team in game $g$,  \n$X_{g,t} = -1$ if team $t$ is the away team in game $g$,\n$X_{g,t} = 0$ otherwise.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nconstruct_model_matrix <- function(d, homeCol = \"home\", awayCol = \"away\") {\n  n_games <- nrow(d)\n  n_teams <- length(unique(unlist(d[, homeCol], d[, awayCol])))\n  \n  m <- matrix(0, \n              nrow = n_games, \n              ncol = n_teams)\n  \n  for (g in 1:n_games) {\n    m[g, as.numeric(d[g, homeCol])] <-  1\n    m[g, as.numeric(d[g, awayCol])] <- -1\n  }\n  \n  return(m)\n}\n\nX <- construct_model_matrix(d)\nX\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n     [,1] [,2] [,3] [,4]\n[1,]    1   -1    0    0\n[2,]    0    1   -1    0\n[3,]   -1    0    0    1\n[4,]    0    0    1   -1\n[5,]    1    0   -1    0\n```\n\n\n:::\n:::\n\n\n\n## Model\n\nA model for the indicator of who won is \n\n$$H_g \\stackrel{ind}{\\sim} Ber(\\pi_g)$$\n\nwhere \n\n- $H_g$ is the indicator that the home team won game $g$ and\n- $\\pi_g$ is the probability the home team would win game $g$.\n\nThe probability of winning the game is then related to the team strength using\nthe typical logit function. \n\n$$\\mbox{logit}(\\pi_g) \n= \\log \\left( \\frac{\\pi_g}{1-\\pi_g} \\right) \n= \\eta_g \n= \\eta + \\theta_{H[g]} - \\theta_{A[g]}$$\n\nwhere, for game $g$,\n\n- $H[g]$ is the ID for the home team, and \n- $A[g]$ is the ID for the away team.\n\nThe parameters are \n\n- $\\eta$ is the home field advantage \n- $\\theta_t$ is the strength of team $t$. \n\nThe probability of team H winning at home against team A is. \n\n$$\\pi_g \n= \\mbox{expit}(\\eta_g) \n= \\left\\{ 1 + \\exp[-\\eta_g] \\right\\}^{-1}\n= \\left\\{ 1 + \\exp[-(\\eta + \\theta_{H} - \\theta_{A})] \\right\\}^{-1}$$\n\n\n::: {.cell}\n\n```{.r .cell-code}\nexpit <- function(eta) {\n  1 / (1 + exp(-eta))\n}\n```\n:::\n\n\n### Identifiability\n\nSimilar to the margin-of-victory models, \nthe individual $\\theta$s are not *identifiable*, but only their \ndifference is. \n\n### Graph connectednss\n\nJust like the margin of victory models we will also have identifiability \nissues if the graph isn't connected.\nIf the graph is sparsely connected, as happens with conference play,\nthen games that connect parts of the graph will have an outsized influence\non the overall estimate of team strength. \n\n\n### Separation\n\nAn issue that exists in these models for binary outcome that doesn't exist for\nthe margin-of-victory models is the issue of separation. \n\n::: {.callout-note}\n## Separation\nA *complete separation* in a win-loss model occurs when \none team has either won or lost all of their games. \n:::\n\nIf a team has won all of their games, then it is impossible to determine how\ngood that team is. \nThus their team strength can be arbitrarily large. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nm <- glm(d$home_win ~ X, family = binomial(link = \"logit\")) \n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: glm.fit: fitted probabilities numerically 0 or 1 occurred\n```\n\n\n:::\n:::\n\n\nThe warning in this output is an indication that separation has occurred. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(m)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nglm(formula = d$home_win ~ X, family = binomial(link = \"logit\"))\n\nCoefficients: (1 not defined because of singularities)\n              Estimate Std. Error z value Pr(>|z|)\n(Intercept)      7.429  72844.703       0        1\nX1              32.606 125856.238       0        1\nX2             -14.266 153887.408       0        1\nX3              16.709  95064.223       0        1\nX4                  NA         NA      NA       NA\n\n(Dispersion parameter for binomial family taken to be 1)\n\n    Null deviance: 6.7301e+00  on 4  degrees of freedom\nResidual deviance: 3.5615e-10  on 1  degrees of freedom\nAIC: 8\n\nNumber of Fisher Scoring iterations: 23\n```\n\n\n:::\n:::\n\n\nThe large standard errors are another indication that separation has occurred.\nOf course, it is best practice to make sure that every team has won and lost\nat least one game before you get to the step of fitting the model.\n\nSeparation can also be observed if the home team wins every game. \nIn this situation, the home advantage parameter can be arbitrarily large. \n\nOther separation situations can occur. \nFor example, imagine that there are two conferences and, in every \ninter-conference game, one conference wins all the games. \nIn this situation, we have no information about how much better one \nconference is than the other. \n\nSeparation is typical problem in logistic regression models, \nbut particularly a problem in the types of models we are using for win-loss\ndata.\n\n\n### Transivity\n\nSimilar to margin-of-victory models, \nthis win-loss model is transitive:\nif Team A is better than Team B and Team B is better than Team C then\nTeam A is better than Team C. \nThat is, there is no information about specific matchups. \n\n\n\n\n\n## Rating Systems\n\nAnybody know of any purely win-loss ratings systems?\nPerhaps one of the tennis rating systems:\n\n- [National Tennis Rating Program (NTRP)](https://www.usta.com/en/home/coach-organize/tennis-tool-center/run-usta-programs/national/understanding-ntrp-ratings.html)\n- Universal Tennis Rating\n- World Tennis Number\n- ATP\n- WTA\n- ITF\n\n\n\n\n## Examples\n\n### Iowa High School Football\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfootball <- read.csv(\"data/Iowa_High_School_Football_4A_Game_Scores_2018.csv\") |>\n  filter(Playoffs == 0) |> # Not playoffs\n  mutate(\n    home_win = HomeScore > AwayScore\n  )\n```\n:::\n\n\nLet's take a look at the graph\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(\"networkD3\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\nAttaching package: 'networkD3'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nThe following object is masked from 'package:DT':\n\n    JS\n```\n\n\n:::\n\n```{.r .cell-code}\np <- simpleNetwork(football, \n                   height=\"100px\", width=\"100px\",        \n        Source = \"AwayTeam\",               \n        Target = \"HomeTeam\",            \n        linkDistance = 10,          # distance between node. Increase this value to have more space between nodes\n        charge = -900,                # numeric value indicating either the strength of the node repulsion (negative value) or attraction (positive value)\n        fontSize = 14,               # size of the node names\n        fontFamily = \"serif\",       # font og node names\n        linkColour = \"#666\",        # colour of edges, MUST be a common colour for the whole graph\n        nodeColour = \"#69b3a2\",     # colour of nodes, MUST be a common colour for the whole graph\n        opacity = 0.9,              # opacity of nodes. 0=transparent. 1=no transparency\n        zoom = T                    # Can you zoom on the figure?\n        )\n\np\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"forceNetwork html-widget html-fill-item\" id=\"htmlwidget-701a5bedfe54bbf98de3\" style=\"width:100%;height:464px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-701a5bedfe54bbf98de3\">{\"x\":{\"links\":{\"source\":[5,2,32,7,33,36,30,20,16,28,15,27,22,4,9,26,37,19,38,25,24,27,35,17,18,39,8,0,15,1,31,6,32,36,41,29,5,21,12,30,17,14,3,22,0,37,19,6,29,41,35,16,7,2,28,18,3,8,33,34,12,40,23,2,25,20,38,26,11,14,39,17,28,8,40,13,39,4,27,26,36,1,5,32,41,24,23,21,15,16,22,9,37,3,6,7,0,11,1,19,10,33,18,29,12,31,25,36,30,35,38,21,14,10,16,7,13,33,39,8,25,34,20,2,32,23,18,14,27,41,15,37,17,5,35,21,11,4,38,3,31,19,34,9,2,6,41,30,24,26,12,40,22,28,0,38,36,7,13,10,3,30,23,16,39,35,6,24,22,29,27,5,1,18,20,26],\"target\":[0,1,3,6,8,10,11,12,14,17,18,21,29,31,35,38,39,41,2,3,5,7,10,14,16,19,20,22,23,26,28,30,33,34,37,40,1,8,11,13,15,18,20,23,24,25,26,27,28,33,36,38,39,40,0,1,5,6,7,9,13,15,16,19,21,24,27,30,32,37,41,0,2,3,6,7,10,11,12,14,18,19,20,25,29,30,31,33,34,35,37,38,2,4,5,8,9,13,15,16,17,20,22,23,24,26,27,28,32,34,39,40,41,0,1,3,4,6,9,11,12,19,21,22,24,26,28,29,30,31,35,36,38,40,1,5,7,8,10,13,14,15,16,17,18,20,23,25,27,29,32,33,36,37,39,0,2,4,8,9,11,12,14,15,17,19,21,25,28,31,32,33,34,37,40,41],\"value\":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],\"colour\":[\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\"]},\"nodes\":{\"name\":[\"Ames\",\"Ankeny\",\"Ankeny Centennial\",\"Bettendorf\",\"Burlington\",\"Cedar Falls\",\"Cedar Rapids Jefferson\",\"Cedar Rapids Kennedy\",\"Cedar Rapids Washington\",\"Council Bluffs Abraham Lincoln\",\"Council Bluffs Thomas Jefferson\",\"Davenport Central\",\"Davenport North\",\"Davenport West\",\"Des Moines East\",\"Des Moines Hoover\",\"Des Moines Lincoln\",\"Des Moines North\",\"Des Moines Roosevelt\",\"Dowling Catholic West Des Moines\",\"Dubuque Hempstead\",\"Dubuque Senior\",\"Fort Dodge\",\"Indianola\",\"Iowa City City High\",\"Iowa City West\",\"Johnston\",\"Linn-Mar Marion\",\"Marshalltown\",\"Mason City\",\"Muscatine\",\"Ottumwa\",\"Pleasant Valley\",\"Prairie Cedar Rapids\",\"Sioux City East\",\"Sioux City North\",\"Sioux City West\",\"Southeast Polk\",\"Urbandale\",\"Valley West Des Moines\",\"Waterloo West\",\"Waukee\"],\"group\":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],\"nodesize\":[8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8]},\"options\":{\"NodeID\":\"name\",\"Group\":\"group\",\"colourScale\":\"d3.scaleOrdinal(['#69b3a2'])\",\"fontSize\":14,\"fontFamily\":\"serif\",\"clickTextSize\":35,\"linkDistance\":10,\"linkWidth\":\"'1.5px'.toString()\",\"charge\":-900,\"opacity\":0.9,\"zoom\":true,\"legend\":false,\"arrows\":false,\"nodesize\":true,\"radiusCalculation\":\"d.nodesize\",\"bounded\":false,\"opacityNoHover\":1,\"clickAction\":null}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\nOverall this graph looks reasonably connected.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Proportion home wins\nfootball |> summarize(p = mean(home_win))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n          p\n1 0.5284091\n```\n\n\n:::\n:::\n\n\nSo we don't have to worry about identifiability of the home-field advantage\nparameter. \n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Team Win-Loss\nfootball |>\n  tidyr::pivot_longer(\n    cols = c(`HomeTeam`, `AwayTeam`),\n    names_to = \"Location\",\n    values_to = \"Team\") |>\n  group_by(Team) |>\n  summarize(\n    n_games = n(),\n    wins    = sum( \n      (home_win & Location == \"HomeTeam\") |\n      (!home_win & Location == \"AwayTeam\") ),\n    loses   = n_games - wins,\n    p       = wins/n_games\n  ) |>\n  arrange(desc(p)) |>\n  datatable(\n    filter = \"top\"\n  )\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"datatables html-widget html-fill-item\" id=\"htmlwidget-fff04bd4322bf90bd693\" style=\"width:100%;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-fff04bd4322bf90bd693\">{\"x\":{\"filter\":\"top\",\"vertical\":false,\"filterHTML\":\"<tr>\\n  <td><\\/td>\\n  <td data-type=\\\"character\\\" style=\\\"vertical-align: top;\\\">\\n    <div class=\\\"form-group has-feedback\\\" style=\\\"margin-bottom: auto;\\\">\\n      <input type=\\\"search\\\" placeholder=\\\"All\\\" class=\\\"form-control\\\" style=\\\"width: 100%;\\\"/>\\n      <span class=\\\"glyphicon glyphicon-remove-circle form-control-feedback\\\"><\\/span>\\n    <\\/div>\\n  <\\/td>\\n  <td data-type=\\\"integer\\\" style=\\\"vertical-align: top;\\\">\\n    <div class=\\\"form-group has-feedback\\\" style=\\\"margin-bottom: auto;\\\">\\n      <input type=\\\"search\\\" placeholder=\\\"All\\\" class=\\\"form-control\\\" style=\\\"width: 100%;\\\"/>\\n      <span class=\\\"glyphicon glyphicon-remove-circle form-control-feedback\\\"><\\/span>\\n    <\\/div>\\n    <div style=\\\"display: none;position: absolute;width: 200px;opacity: 1\\\">\\n      <div data-min=\\\"6\\\" data-max=\\\"9\\\"><\\/div>\\n      <span style=\\\"float: left;\\\"><\\/span>\\n      <span style=\\\"float: right;\\\"><\\/span>\\n    <\\/div>\\n  <\\/td>\\n  <td data-type=\\\"integer\\\" style=\\\"vertical-align: top;\\\">\\n    <div class=\\\"form-group has-feedback\\\" style=\\\"margin-bottom: auto;\\\">\\n      <input type=\\\"search\\\" placeholder=\\\"All\\\" class=\\\"form-control\\\" style=\\\"width: 100%;\\\"/>\\n      <span class=\\\"glyphicon glyphicon-remove-circle form-control-feedback\\\"><\\/span>\\n    <\\/div>\\n    <div style=\\\"display: none;position: absolute;width: 200px;opacity: 1\\\">\\n      <div data-min=\\\"0\\\" data-max=\\\"9\\\"><\\/div>\\n      <span style=\\\"float: left;\\\"><\\/span>\\n      <span style=\\\"float: right;\\\"><\\/span>\\n    <\\/div>\\n  <\\/td>\\n  <td data-type=\\\"integer\\\" style=\\\"vertical-align: top;\\\">\\n    <div class=\\\"form-group has-feedback\\\" style=\\\"margin-bottom: auto;\\\">\\n      <input type=\\\"search\\\" placeholder=\\\"All\\\" class=\\\"form-control\\\" style=\\\"width: 100%;\\\"/>\\n      <span class=\\\"glyphicon glyphicon-remove-circle form-control-feedback\\\"><\\/span>\\n    <\\/div>\\n    <div style=\\\"display: none;position: absolute;width: 200px;opacity: 1\\\">\\n      <div data-min=\\\"0\\\" data-max=\\\"8\\\"><\\/div>\\n      <span style=\\\"float: left;\\\"><\\/span>\\n      <span style=\\\"float: right;\\\"><\\/span>\\n    <\\/div>\\n  <\\/td>\\n  <td data-type=\\\"number\\\" style=\\\"vertical-align: top;\\\">\\n    <div class=\\\"form-group has-feedback\\\" style=\\\"margin-bottom: auto;\\\">\\n      <input type=\\\"search\\\" placeholder=\\\"All\\\" class=\\\"form-control\\\" style=\\\"width: 100%;\\\"/>\\n      <span class=\\\"glyphicon glyphicon-remove-circle form-control-feedback\\\"><\\/span>\\n    <\\/div>\\n    <div style=\\\"display: none;position: absolute;width: 200px;opacity: 1\\\">\\n      <div data-min=\\\"0\\\" data-max=\\\"1\\\" data-scale=\\\"15\\\"><\\/div>\\n      <span style=\\\"float: left;\\\"><\\/span>\\n      <span style=\\\"float: right;\\\"><\\/span>\\n    <\\/div>\\n  <\\/td>\\n<\\/tr>\",\"data\":[[\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"10\",\"11\",\"12\",\"13\",\"14\",\"15\",\"16\",\"17\",\"18\",\"19\",\"20\",\"21\",\"22\",\"23\",\"24\",\"25\",\"26\",\"27\",\"28\",\"29\",\"30\",\"31\",\"32\",\"33\",\"34\",\"35\",\"36\",\"37\",\"38\",\"39\",\"40\",\"41\",\"42\"],[\"Ankeny Centennial\",\"Cedar Falls\",\"Valley West Des Moines\",\"Bettendorf\",\"Iowa City West\",\"Dowling Catholic West Des Moines\",\"Johnston\",\"Prairie Cedar Rapids\",\"Waukee\",\"Fort Dodge\",\"Sioux City East\",\"Cedar Rapids Kennedy\",\"Urbandale\",\"Indianola\",\"Pleasant Valley\",\"Ames\",\"Ankeny\",\"Des Moines East\",\"Muscatine\",\"Davenport Central\",\"Davenport North\",\"Cedar Rapids Washington\",\"Des Moines Lincoln\",\"Dubuque Hempstead\",\"Marshalltown\",\"Southeast Polk\",\"Council Bluffs Thomas Jefferson\",\"Dubuque Senior\",\"Des Moines Roosevelt\",\"Linn-Mar Marion\",\"Ottumwa\",\"Sioux City North\",\"Sioux City West\",\"Waterloo West\",\"Council Bluffs Abraham Lincoln\",\"Davenport West\",\"Iowa City City High\",\"Cedar Rapids Jefferson\",\"Des Moines Hoover\",\"Burlington\",\"Des Moines North\",\"Mason City\"],[9,9,9,9,8,9,9,9,9,8,7,9,9,8,8,9,9,9,9,8,8,9,9,9,9,9,7,8,9,9,7,8,8,8,7,7,8,9,9,6,8,8],[9,9,9,8,7,7,7,7,7,6,5,6,6,5,5,5,5,5,5,4,4,4,4,4,4,4,3,3,3,3,2,2,2,2,1,1,1,1,1,0,0,0],[0,0,0,1,1,2,2,2,2,2,2,3,3,3,3,4,4,4,4,4,4,5,5,5,5,5,4,5,6,6,5,6,6,6,6,6,7,8,8,6,8,8],[1,1,1,0.8888888888888888,0.875,0.7777777777777778,0.7777777777777778,0.7777777777777778,0.7777777777777778,0.75,0.7142857142857143,0.6666666666666666,0.6666666666666666,0.625,0.625,0.5555555555555556,0.5555555555555556,0.5555555555555556,0.5555555555555556,0.5,0.5,0.4444444444444444,0.4444444444444444,0.4444444444444444,0.4444444444444444,0.4444444444444444,0.4285714285714285,0.375,0.3333333333333333,0.3333333333333333,0.2857142857142857,0.25,0.25,0.25,0.1428571428571428,0.1428571428571428,0.125,0.1111111111111111,0.1111111111111111,0,0,0]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>Team<\\/th>\\n      <th>n_games<\\/th>\\n      <th>wins<\\/th>\\n      <th>loses<\\/th>\\n      <th>p<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"columnDefs\":[{\"className\":\"dt-right\",\"targets\":[2,3,4,5]},{\"orderable\":false,\"targets\":0},{\"name\":\" \",\"targets\":0},{\"name\":\"Team\",\"targets\":1},{\"name\":\"n_games\",\"targets\":2},{\"name\":\"wins\",\"targets\":3},{\"name\":\"loses\",\"targets\":4},{\"name\":\"p\",\"targets\":5}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false,\"orderCellsTop\":true}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\nWith these data, we have many teams that either have all wins or all loses. \nThese data are not appropriate for these models. \n\n\n\n### International Handball\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhandball2024 <- read_csv(\"data/Handball_W_InternationalResults.csv\",\n                     col_types = cols(\n                       ScoreA = col_double(),\n                       ScoreB = col_double(),\n                       year = col_integer(),\n                       Date = col_date(),\n                       .default = col_character()\n                     )) |>\n  filter(year == 2024,\n         !(TeamA %in% c(\"Romania\", \n                        \"Bosnia and Herzegovina\", \n                        \"Greece\", \n                        \"Croatia\"))) |>\n  mutate(\n    margin = ScoreA - ScoreB,\n    A_win  = margin > 0\n  )\n```\n:::\n\n\nI didn't bother calculating statistics here because due to the small number\nof games each team played, there will definitely be some teams that have 0 \nwins and some that have 0 loses. \n\n\n\n### Waterpolo\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwaterpolo <- read.csv(\"data/waterpolo_Men.csv\") |>\n  mutate(TeamA_win = Winner == TeamA) # Create binary win variable\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nwaterpolo |>\n  tidyr::pivot_longer(\n    cols = c(\"TeamA\", \"TeamB\"),\n    names_to = \"AorB\",\n    values_to = \"Team\"\n  ) |>\n  group_by(Team) |>\n  summarize(\n    n    = n(),\n    wins = sum(\n      (TeamA_win & AorB == \"TeamA\") |\n        (!TeamA_win & AorB == \"TeamB\")\n      ),\n    loses = n - wins,\n    p     = wins / n\n  ) |>\n  arrange(desc(p)) |>\n  datatable(\n    filter = \"top\"\n  )\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"datatables html-widget html-fill-item\" id=\"htmlwidget-fca55ef3aa8288cc6ec2\" style=\"width:100%;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-fca55ef3aa8288cc6ec2\">{\"x\":{\"filter\":\"top\",\"vertical\":false,\"filterHTML\":\"<tr>\\n  <td><\\/td>\\n  <td data-type=\\\"character\\\" style=\\\"vertical-align: top;\\\">\\n    <div class=\\\"form-group has-feedback\\\" style=\\\"margin-bottom: auto;\\\">\\n      <input type=\\\"search\\\" placeholder=\\\"All\\\" class=\\\"form-control\\\" style=\\\"width: 100%;\\\"/>\\n      <span class=\\\"glyphicon glyphicon-remove-circle form-control-feedback\\\"><\\/span>\\n    <\\/div>\\n  <\\/td>\\n  <td data-type=\\\"integer\\\" style=\\\"vertical-align: top;\\\">\\n    <div class=\\\"form-group has-feedback\\\" style=\\\"margin-bottom: auto;\\\">\\n      <input type=\\\"search\\\" placeholder=\\\"All\\\" class=\\\"form-control\\\" style=\\\"width: 100%;\\\"/>\\n      <span class=\\\"glyphicon glyphicon-remove-circle form-control-feedback\\\"><\\/span>\\n    <\\/div>\\n    <div style=\\\"display: none;position: absolute;width: 200px;opacity: 1\\\">\\n      <div data-min=\\\"4\\\" data-max=\\\"41\\\"><\\/div>\\n      <span style=\\\"float: left;\\\"><\\/span>\\n      <span style=\\\"float: right;\\\"><\\/span>\\n    <\\/div>\\n  <\\/td>\\n  <td data-type=\\\"integer\\\" style=\\\"vertical-align: top;\\\">\\n    <div class=\\\"form-group has-feedback\\\" style=\\\"margin-bottom: auto;\\\">\\n      <input type=\\\"search\\\" placeholder=\\\"All\\\" class=\\\"form-control\\\" style=\\\"width: 100%;\\\"/>\\n      <span class=\\\"glyphicon glyphicon-remove-circle form-control-feedback\\\"><\\/span>\\n    <\\/div>\\n    <div style=\\\"display: none;position: absolute;width: 200px;opacity: 1\\\">\\n      <div data-min=\\\"0\\\" data-max=\\\"31\\\"><\\/div>\\n      <span style=\\\"float: left;\\\"><\\/span>\\n      <span style=\\\"float: right;\\\"><\\/span>\\n    <\\/div>\\n  <\\/td>\\n  <td data-type=\\\"integer\\\" style=\\\"vertical-align: top;\\\">\\n    <div class=\\\"form-group has-feedback\\\" style=\\\"margin-bottom: auto;\\\">\\n      <input type=\\\"search\\\" placeholder=\\\"All\\\" class=\\\"form-control\\\" style=\\\"width: 100%;\\\"/>\\n      <span class=\\\"glyphicon glyphicon-remove-circle form-control-feedback\\\"><\\/span>\\n    <\\/div>\\n    <div style=\\\"display: none;position: absolute;width: 200px;opacity: 1\\\">\\n      <div data-min=\\\"2\\\" data-max=\\\"19\\\"><\\/div>\\n      <span style=\\\"float: left;\\\"><\\/span>\\n      <span style=\\\"float: right;\\\"><\\/span>\\n    <\\/div>\\n  <\\/td>\\n  <td data-type=\\\"number\\\" style=\\\"vertical-align: top;\\\">\\n    <div class=\\\"form-group has-feedback\\\" style=\\\"margin-bottom: auto;\\\">\\n      <input type=\\\"search\\\" placeholder=\\\"All\\\" class=\\\"form-control\\\" style=\\\"width: 100%;\\\"/>\\n      <span class=\\\"glyphicon glyphicon-remove-circle form-control-feedback\\\"><\\/span>\\n    <\\/div>\\n    <div style=\\\"display: none;position: absolute;width: 200px;opacity: 1\\\">\\n      <div data-min=\\\"0\\\" data-max=\\\"0.815789473684211\\\" data-scale=\\\"15\\\"><\\/div>\\n      <span style=\\\"float: left;\\\"><\\/span>\\n      <span style=\\\"float: right;\\\"><\\/span>\\n    <\\/div>\\n  <\\/td>\\n<\\/tr>\",\"data\":[[\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"10\",\"11\",\"12\",\"13\",\"14\",\"15\",\"16\",\"17\",\"18\",\"19\",\"20\",\"21\",\"22\",\"23\",\"24\",\"25\",\"26\",\"27\",\"28\",\"29\",\"30\",\"31\",\"32\",\"33\",\"34\",\"35\",\"36\",\"37\"],[\"Montenegro\",\"United States\",\"Serbia\",\"Hungary\",\"Italy\",\"Croatia\",\"Spain\",\"Iran\",\"Greece\",\"Australia\",\"China\",\"Argentina\",\"Japan\",\"Cuba\",\"Russia\",\"Brazil\",\"Kazakhstan\",\"Netherlands\",\"Canada\",\"South Korea\",\"Mexico\",\"France\",\"Germany\",\"Georgia\",\"Indonesia\",\"Saudi Arabia\",\"New Zealand\",\"Romania\",\"Slovakia\",\"Puerto Rico\",\"Singapore\",\"Turkey\",\"Hong Kong\",\"Malta\",\"Peru\",\"South Africa\",\"Ukraine\"],[38,18,30,32,30,38,34,6,41,18,12,11,30,6,26,15,28,21,24,11,6,28,24,21,7,7,10,15,5,6,6,6,4,11,6,11,8],[31,14,23,24,22,26,23,4,26,11,7,6,16,3,13,7,11,8,9,4,2,9,7,6,2,2,2,3,1,1,1,1,0,0,0,0,0],[7,4,7,8,8,12,11,2,15,7,5,5,14,3,13,8,17,13,15,7,4,19,17,15,5,5,8,12,4,5,5,5,4,11,6,11,8],[0.8157894736842105,0.7777777777777778,0.7666666666666667,0.75,0.7333333333333333,0.6842105263157895,0.6764705882352942,0.6666666666666666,0.6341463414634146,0.6111111111111112,0.5833333333333334,0.5454545454545454,0.5333333333333333,0.5,0.5,0.4666666666666667,0.3928571428571428,0.3809523809523809,0.375,0.3636363636363636,0.3333333333333333,0.3214285714285715,0.2916666666666667,0.2857142857142857,0.2857142857142857,0.2857142857142857,0.2,0.2,0.2,0.1666666666666667,0.1666666666666667,0.1666666666666667,0,0,0,0,0]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>Team<\\/th>\\n      <th>n<\\/th>\\n      <th>wins<\\/th>\\n      <th>loses<\\/th>\\n      <th>p<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"columnDefs\":[{\"className\":\"dt-right\",\"targets\":[2,3,4,5]},{\"orderable\":false,\"targets\":0},{\"name\":\" \",\"targets\":0},{\"name\":\"Team\",\"targets\":1},{\"name\":\"n\",\"targets\":2},{\"name\":\"wins\",\"targets\":3},{\"name\":\"loses\",\"targets\":4},{\"name\":\"p\",\"targets\":5}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false,\"orderCellsTop\":true}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n\n\n### Tennis\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntennis <- read.csv(\"data/tennis.csv\") |>\n  mutate(\n    Date = as.Date(Date)\n  ) |>\n  # Select only 2019 games\n  filter(Date > as.Date(\"2018-12-31\")) |>\n  select(Winner, Loser) \n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntennis_win_loss <- tennis |>\n  tidyr::pivot_longer(\n    cols = c(\"Winner\", \"Loser\"),\n    names_to = \"Win\",\n    values_to = \"Player\"\n  ) |>\n  group_by(Player) |>\n  summarize(\n    n    = n(),\n    wins = sum(Win == \"Winner\"),\n    loses = n - wins,\n    p     = wins / n\n  ) |>\n  filter(n > 20) |>\n  arrange(desc(p))\n\ntennis_win_loss |>\n  datatable(\n    filter = \"top\"\n  )\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"datatables html-widget html-fill-item\" id=\"htmlwidget-5aa32609149d90959d47\" style=\"width:100%;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-5aa32609149d90959d47\">{\"x\":{\"filter\":\"top\",\"vertical\":false,\"filterHTML\":\"<tr>\\n  <td><\\/td>\\n  <td data-type=\\\"character\\\" style=\\\"vertical-align: top;\\\">\\n    <div class=\\\"form-group has-feedback\\\" style=\\\"margin-bottom: auto;\\\">\\n      <input type=\\\"search\\\" placeholder=\\\"All\\\" class=\\\"form-control\\\" style=\\\"width: 100%;\\\"/>\\n      <span class=\\\"glyphicon glyphicon-remove-circle form-control-feedback\\\"><\\/span>\\n    <\\/div>\\n  <\\/td>\\n  <td data-type=\\\"integer\\\" style=\\\"vertical-align: top;\\\">\\n    <div class=\\\"form-group has-feedback\\\" style=\\\"margin-bottom: auto;\\\">\\n      <input type=\\\"search\\\" placeholder=\\\"All\\\" class=\\\"form-control\\\" style=\\\"width: 100%;\\\"/>\\n      <span class=\\\"glyphicon glyphicon-remove-circle form-control-feedback\\\"><\\/span>\\n    <\\/div>\\n    <div style=\\\"display: none;position: absolute;width: 200px;opacity: 1\\\">\\n      <div data-min=\\\"22\\\" data-max=\\\"82\\\"><\\/div>\\n      <span style=\\\"float: left;\\\"><\\/span>\\n      <span style=\\\"float: right;\\\"><\\/span>\\n    <\\/div>\\n  <\\/td>\\n  <td data-type=\\\"integer\\\" style=\\\"vertical-align: top;\\\">\\n    <div class=\\\"form-group has-feedback\\\" style=\\\"margin-bottom: auto;\\\">\\n      <input type=\\\"search\\\" placeholder=\\\"All\\\" class=\\\"form-control\\\" style=\\\"width: 100%;\\\"/>\\n      <span class=\\\"glyphicon glyphicon-remove-circle form-control-feedback\\\"><\\/span>\\n    <\\/div>\\n    <div style=\\\"display: none;position: absolute;width: 200px;opacity: 1\\\">\\n      <div data-min=\\\"6\\\" data-max=\\\"56\\\"><\\/div>\\n      <span style=\\\"float: left;\\\"><\\/span>\\n      <span style=\\\"float: right;\\\"><\\/span>\\n    <\\/div>\\n  <\\/td>\\n  <td data-type=\\\"integer\\\" style=\\\"vertical-align: top;\\\">\\n    <div class=\\\"form-group has-feedback\\\" style=\\\"margin-bottom: auto;\\\">\\n      <input type=\\\"search\\\" placeholder=\\\"All\\\" class=\\\"form-control\\\" style=\\\"width: 100%;\\\"/>\\n      <span class=\\\"glyphicon glyphicon-remove-circle form-control-feedback\\\"><\\/span>\\n    <\\/div>\\n    <div style=\\\"display: none;position: absolute;width: 200px;opacity: 1\\\">\\n      <div data-min=\\\"8\\\" data-max=\\\"28\\\"><\\/div>\\n      <span style=\\\"float: left;\\\"><\\/span>\\n      <span style=\\\"float: right;\\\"><\\/span>\\n    <\\/div>\\n  <\\/td>\\n  <td data-type=\\\"number\\\" style=\\\"vertical-align: top;\\\">\\n    <div class=\\\"form-group has-feedback\\\" style=\\\"margin-bottom: auto;\\\">\\n      <input type=\\\"search\\\" placeholder=\\\"All\\\" class=\\\"form-control\\\" style=\\\"width: 100%;\\\"/>\\n      <span class=\\\"glyphicon glyphicon-remove-circle form-control-feedback\\\"><\\/span>\\n    <\\/div>\\n    <div style=\\\"display: none;position: absolute;width: 200px;opacity: 1\\\">\\n      <div data-min=\\\"0.272727272727272\\\" data-max=\\\"0.813953488372093\\\" data-scale=\\\"15\\\"><\\/div>\\n      <span style=\\\"float: left;\\\"><\\/span>\\n      <span style=\\\"float: right;\\\"><\\/span>\\n    <\\/div>\\n  <\\/td>\\n<\\/tr>\",\"data\":[[\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"10\",\"11\",\"12\",\"13\",\"14\",\"15\",\"16\",\"17\",\"18\",\"19\",\"20\",\"21\",\"22\",\"23\",\"24\",\"25\",\"26\",\"27\",\"28\",\"29\",\"30\",\"31\",\"32\",\"33\",\"34\",\"35\",\"36\",\"37\",\"38\",\"39\",\"40\",\"41\",\"42\",\"43\",\"44\",\"45\",\"46\",\"47\",\"48\",\"49\",\"50\",\"51\",\"52\",\"53\",\"54\",\"55\",\"56\",\"57\",\"58\",\"59\",\"60\",\"61\",\"62\",\"63\",\"64\",\"65\",\"66\",\"67\",\"68\",\"69\",\"70\",\"71\",\"72\",\"73\",\"74\",\"75\",\"76\",\"77\",\"78\",\"79\",\"80\",\"81\",\"82\",\"83\",\"84\",\"85\",\"86\",\"87\",\"88\",\"89\",\"90\"],[\"Andreescu B.\",\"Barty A.\",\"Pliskova Ka.\",\"Williams S.\",\"Osaka N.\",\"Vondrousova M.\",\"Kvitova P.\",\"Rybakina E.\",\"Halep S.\",\"Bencic B.\",\"Kenin S.\",\"Konta J.\",\"Bertens K.\",\"Martic P.\",\"Keys M.\",\"Muchova K.\",\"Svitolina E.\",\"Anisimova A.\",\"Sabalenka A.\",\"Yastremska D.\",\"Muguruza G.\",\"Mertens E.\",\"Kerber A.\",\"Vekic D.\",\"Kontaveit A.\",\"Peterson R.\",\"Linette M.\",\"Van Uytvanck A.\",\"Williams V.\",\"Wozniacki C.\",\"Sakkari M.\",\"Goerges J.\",\"Kudermetova V.\",\"Hsieh S.W.\",\"Swiatek I.\",\"Azarenka V.\",\"Mladenovic K.\",\"Sevastova A.\",\"Wang Q.\",\"Putintseva Y.\",\"Alexandrova E.\",\"Teichmann J.\",\"Stephens S.\",\"Cornet A.\",\"Wang Yaf.\",\"Riske A.\",\"Cirstea S.\",\"Kuznetsova S.\",\"Garcia C.\",\"Collins D.\",\"Kuzmova V.\",\"Pavlyuchenkova A.\",\"Ostapenko J.\",\"Zheng S.\",\"Strycova B.\",\"Ferro F.\",\"Suarez Navarro C.\",\"Brady J.\",\"Pera B.\",\"Stosur S.\",\"Blinkova A.\",\"Giorgi C.\",\"Tomljanovic A.\",\"Tsurenko L.\",\"Hercog P.\",\"Zidansek T.\",\"Pliskova Kr.\",\"Petkovic A.\",\"Zhang S.\",\"Kozlova K.\",\"Potapova A.\",\"Puig M.\",\"Begu I.\",\"Golubic V.\",\"Siegemund L.\",\"Gasparyan M.\",\"Jabeur O.\",\"Pegula J.\",\"Flipkens K.\",\"Siniakova K.\",\"Kasatkina D.\",\"Sasnovich A.\",\"Maria T.\",\"Sorribes Tormo S.\",\"Buzarnescu M.\",\"Doi M.\",\"Bonaventure Y.\",\"Parmentier P.\",\"Babos T.\",\"Gavrilova D.\"],[43,64,66,33,53,36,53,33,56,69,71,48,82,53,40,40,62,36,56,52,37,59,49,58,41,43,40,42,35,35,51,46,46,55,25,38,49,49,40,51,53,22,41,43,45,47,32,27,47,36,46,42,51,43,39,33,33,31,31,31,27,27,54,27,40,32,39,35,40,29,29,34,25,25,35,33,33,22,37,47,33,36,31,29,35,22,26,32,22,22],[35,52,50,25,40,27,37,23,39,48,49,33,56,36,27,27,40,23,35,31,22,35,29,34,24,25,23,24,20,20,29,26,26,31,14,21,27,27,22,28,29,12,22,23,24,25,17,14,24,18,23,21,25,21,19,16,16,15,15,15,13,13,26,13,19,15,18,16,18,13,13,15,11,11,15,14,14,9,15,19,13,14,12,11,13,8,9,10,6,6],[8,12,16,8,13,9,16,10,17,21,22,15,26,17,13,13,22,13,21,21,15,24,20,24,17,18,17,18,15,15,22,20,20,24,11,17,22,22,18,23,24,10,19,20,21,22,15,13,23,18,23,21,26,22,20,17,17,16,16,16,14,14,28,14,21,17,21,19,22,16,16,19,14,14,20,19,19,13,22,28,20,22,19,18,22,14,17,22,16,16],[0.813953488372093,0.8125,0.7575757575757576,0.7575757575757576,0.7547169811320755,0.75,0.6981132075471698,0.696969696969697,0.6964285714285714,0.6956521739130435,0.6901408450704225,0.6875,0.6829268292682927,0.6792452830188679,0.675,0.675,0.6451612903225806,0.6388888888888888,0.625,0.5961538461538461,0.5945945945945946,0.5932203389830508,0.5918367346938775,0.5862068965517241,0.5853658536585366,0.5813953488372093,0.575,0.5714285714285714,0.5714285714285714,0.5714285714285714,0.5686274509803921,0.5652173913043478,0.5652173913043478,0.5636363636363636,0.5600000000000001,0.5526315789473685,0.5510204081632653,0.5510204081632653,0.55,0.5490196078431373,0.5471698113207547,0.5454545454545454,0.5365853658536586,0.5348837209302325,0.5333333333333333,0.5319148936170213,0.53125,0.5185185185185185,0.5106382978723404,0.5,0.5,0.5,0.4901960784313725,0.4883720930232558,0.4871794871794872,0.4848484848484849,0.4848484848484849,0.4838709677419355,0.4838709677419355,0.4838709677419355,0.4814814814814815,0.4814814814814815,0.4814814814814815,0.4814814814814815,0.475,0.46875,0.4615384615384616,0.4571428571428571,0.45,0.4482758620689655,0.4482758620689655,0.4411764705882353,0.44,0.44,0.4285714285714285,0.4242424242424243,0.4242424242424243,0.4090909090909091,0.4054054054054054,0.4042553191489361,0.3939393939393939,0.3888888888888889,0.3870967741935484,0.3793103448275862,0.3714285714285714,0.3636363636363636,0.3461538461538461,0.3125,0.2727272727272727,0.2727272727272727]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>Player<\\/th>\\n      <th>n<\\/th>\\n      <th>wins<\\/th>\\n      <th>loses<\\/th>\\n      <th>p<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"columnDefs\":[{\"className\":\"dt-right\",\"targets\":[2,3,4,5]},{\"orderable\":false,\"targets\":0},{\"name\":\" \",\"targets\":0},{\"name\":\"Player\",\"targets\":1},{\"name\":\"n\",\"targets\":2},{\"name\":\"wins\",\"targets\":3},{\"name\":\"loses\",\"targets\":4},{\"name\":\"p\",\"targets\":5}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false,\"orderCellsTop\":true}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\nLimit the data to only individuals who have played at least 20 games. \nWhen we eliminate some games, \nthe individuals remaining may have less than 20 games. \nThe hope is that everybody has at least one win and one loss. \n\n\n::: {.cell}\n\n```{.r .cell-code}\ntennis_filtered <- tennis |>\n  filter(\n    Winner %in% tennis_win_loss$Player & \n      Loser %in% tennis_win_loss$Player\n  )\n\ntennis_filtered |>  \n  tidyr::pivot_longer(\n    cols = c(\"Winner\", \"Loser\"),\n    names_to = \"Win\",\n    values_to = \"Player\"\n  ) |>\n  group_by(Player) |>\n  summarize(\n    n    = n(),\n    wins = sum(Win == \"Winner\"),\n    loses = n - wins,\n    p     = wins / n\n  ) |>\n  # filter(n > 20) |>\n  arrange(desc(p)) |>\n  datatable(\n    filter = \"top\"\n  )\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"datatables html-widget html-fill-item\" id=\"htmlwidget-8ff9eea9e1ed969e20e4\" style=\"width:100%;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-8ff9eea9e1ed969e20e4\">{\"x\":{\"filter\":\"top\",\"vertical\":false,\"filterHTML\":\"<tr>\\n  <td><\\/td>\\n  <td data-type=\\\"character\\\" style=\\\"vertical-align: top;\\\">\\n    <div class=\\\"form-group has-feedback\\\" style=\\\"margin-bottom: auto;\\\">\\n      <input type=\\\"search\\\" placeholder=\\\"All\\\" class=\\\"form-control\\\" style=\\\"width: 100%;\\\"/>\\n      <span class=\\\"glyphicon glyphicon-remove-circle form-control-feedback\\\"><\\/span>\\n    <\\/div>\\n  <\\/td>\\n  <td data-type=\\\"integer\\\" style=\\\"vertical-align: top;\\\">\\n    <div class=\\\"form-group has-feedback\\\" style=\\\"margin-bottom: auto;\\\">\\n      <input type=\\\"search\\\" placeholder=\\\"All\\\" class=\\\"form-control\\\" style=\\\"width: 100%;\\\"/>\\n      <span class=\\\"glyphicon glyphicon-remove-circle form-control-feedback\\\"><\\/span>\\n    <\\/div>\\n    <div style=\\\"display: none;position: absolute;width: 200px;opacity: 1\\\">\\n      <div data-min=\\\"13\\\" data-max=\\\"65\\\"><\\/div>\\n      <span style=\\\"float: left;\\\"><\\/span>\\n      <span style=\\\"float: right;\\\"><\\/span>\\n    <\\/div>\\n  <\\/td>\\n  <td data-type=\\\"integer\\\" style=\\\"vertical-align: top;\\\">\\n    <div class=\\\"form-group has-feedback\\\" style=\\\"margin-bottom: auto;\\\">\\n      <input type=\\\"search\\\" placeholder=\\\"All\\\" class=\\\"form-control\\\" style=\\\"width: 100%;\\\"/>\\n      <span class=\\\"glyphicon glyphicon-remove-circle form-control-feedback\\\"><\\/span>\\n    <\\/div>\\n    <div style=\\\"display: none;position: absolute;width: 200px;opacity: 1\\\">\\n      <div data-min=\\\"3\\\" data-max=\\\"46\\\"><\\/div>\\n      <span style=\\\"float: left;\\\"><\\/span>\\n      <span style=\\\"float: right;\\\"><\\/span>\\n    <\\/div>\\n  <\\/td>\\n  <td data-type=\\\"integer\\\" style=\\\"vertical-align: top;\\\">\\n    <div class=\\\"form-group has-feedback\\\" style=\\\"margin-bottom: auto;\\\">\\n      <input type=\\\"search\\\" placeholder=\\\"All\\\" class=\\\"form-control\\\" style=\\\"width: 100%;\\\"/>\\n      <span class=\\\"glyphicon glyphicon-remove-circle form-control-feedback\\\"><\\/span>\\n    <\\/div>\\n    <div style=\\\"display: none;position: absolute;width: 200px;opacity: 1\\\">\\n      <div data-min=\\\"7\\\" data-max=\\\"27\\\"><\\/div>\\n      <span style=\\\"float: left;\\\"><\\/span>\\n      <span style=\\\"float: right;\\\"><\\/span>\\n    <\\/div>\\n  <\\/td>\\n  <td data-type=\\\"number\\\" style=\\\"vertical-align: top;\\\">\\n    <div class=\\\"form-group has-feedback\\\" style=\\\"margin-bottom: auto;\\\">\\n      <input type=\\\"search\\\" placeholder=\\\"All\\\" class=\\\"form-control\\\" style=\\\"width: 100%;\\\"/>\\n      <span class=\\\"glyphicon glyphicon-remove-circle form-control-feedback\\\"><\\/span>\\n    <\\/div>\\n    <div style=\\\"display: none;position: absolute;width: 200px;opacity: 1\\\">\\n      <div data-min=\\\"0.16\\\" data-max=\\\"0.793103448275863\\\" data-scale=\\\"15\\\"><\\/div>\\n      <span style=\\\"float: left;\\\"><\\/span>\\n      <span style=\\\"float: right;\\\"><\\/span>\\n    <\\/div>\\n  <\\/td>\\n<\\/tr>\",\"data\":[[\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"10\",\"11\",\"12\",\"13\",\"14\",\"15\",\"16\",\"17\",\"18\",\"19\",\"20\",\"21\",\"22\",\"23\",\"24\",\"25\",\"26\",\"27\",\"28\",\"29\",\"30\",\"31\",\"32\",\"33\",\"34\",\"35\",\"36\",\"37\",\"38\",\"39\",\"40\",\"41\",\"42\",\"43\",\"44\",\"45\",\"46\",\"47\",\"48\",\"49\",\"50\",\"51\",\"52\",\"53\",\"54\",\"55\",\"56\",\"57\",\"58\",\"59\",\"60\",\"61\",\"62\",\"63\",\"64\",\"65\",\"66\",\"67\",\"68\",\"69\",\"70\",\"71\",\"72\",\"73\",\"74\",\"75\",\"76\",\"77\",\"78\",\"79\",\"80\",\"81\",\"82\",\"83\",\"84\",\"85\",\"86\",\"87\",\"88\",\"89\",\"90\"],[\"Barty A.\",\"Andreescu B.\",\"Vondrousova M.\",\"Pliskova Ka.\",\"Osaka N.\",\"Halep S.\",\"Kvitova P.\",\"Williams S.\",\"Bencic B.\",\"Keys M.\",\"Kenin S.\",\"Martic P.\",\"Konta J.\",\"Svitolina E.\",\"Bertens K.\",\"Muchova K.\",\"Sabalenka A.\",\"Mertens E.\",\"Stephens S.\",\"Kudermetova V.\",\"Riske A.\",\"Kuznetsova S.\",\"Peterson R.\",\"Van Uytvanck A.\",\"Hsieh S.W.\",\"Kerber A.\",\"Williams V.\",\"Wozniacki C.\",\"Yastremska D.\",\"Kontaveit A.\",\"Goerges J.\",\"Pavlyuchenkova A.\",\"Vekic D.\",\"Muguruza G.\",\"Putintseva Y.\",\"Wang Q.\",\"Linette M.\",\"Mladenovic K.\",\"Ostapenko J.\",\"Rybakina E.\",\"Hercog P.\",\"Azarenka V.\",\"Alexandrova E.\",\"Petkovic A.\",\"Sakkari M.\",\"Teichmann J.\",\"Anisimova A.\",\"Ferro F.\",\"Zidansek T.\",\"Brady J.\",\"Suarez Navarro C.\",\"Sevastova A.\",\"Strycova B.\",\"Kozlova K.\",\"Swiatek I.\",\"Kuzmova V.\",\"Zheng S.\",\"Wang Yaf.\",\"Tomljanovic A.\",\"Zhang S.\",\"Cornet A.\",\"Potapova A.\",\"Puig M.\",\"Blinkova A.\",\"Pera B.\",\"Collins D.\",\"Giorgi C.\",\"Cirstea S.\",\"Garcia C.\",\"Stosur S.\",\"Tsurenko L.\",\"Siniakova K.\",\"Jabeur O.\",\"Sasnovich A.\",\"Bonaventure Y.\",\"Doi M.\",\"Kasatkina D.\",\"Gasparyan M.\",\"Golubic V.\",\"Maria T.\",\"Pegula J.\",\"Babos T.\",\"Pliskova Kr.\",\"Buzarnescu M.\",\"Begu I.\",\"Siegemund L.\",\"Gavrilova D.\",\"Parmentier P.\",\"Sorribes Tormo S.\",\"Flipkens K.\"],[58,36,32,58,46,49,50,25,55,32,58,46,43,59,65,33,47,47,35,32,38,20,33,33,46,41,28,30,45,34,31,35,47,26,41,31,25,38,38,19,34,32,43,26,39,13,22,22,22,29,27,33,33,19,19,34,34,32,42,30,28,18,26,21,21,29,22,17,34,20,20,40,28,28,16,16,26,23,17,17,17,14,19,27,13,22,15,21,18,25],[46,28,24,42,33,34,34,17,37,21,38,30,28,38,40,20,28,27,20,18,21,11,18,18,25,22,15,16,24,18,16,18,24,13,20,15,12,18,18,9,16,15,20,12,18,6,10,10,10,13,12,14,14,8,8,14,14,13,17,12,11,7,10,8,8,11,8,6,12,7,7,13,9,9,5,5,8,7,5,5,5,4,5,7,3,5,3,4,3,4],[12,8,8,16,13,15,16,8,18,11,20,16,15,21,25,13,19,20,15,14,17,9,15,15,21,19,13,14,21,16,15,17,23,13,21,16,13,20,20,10,18,17,23,14,21,7,12,12,12,16,15,19,19,11,11,20,20,19,25,18,17,11,16,13,13,18,14,11,22,13,13,27,19,19,11,11,18,16,12,12,12,10,14,20,10,17,12,17,15,21],[0.7931034482758621,0.7777777777777778,0.75,0.7241379310344828,0.7173913043478261,0.6938775510204082,0.68,0.68,0.6727272727272727,0.65625,0.6551724137931034,0.6521739130434783,0.6511627906976745,0.6440677966101694,0.6153846153846154,0.6060606060606061,0.5957446808510638,0.574468085106383,0.5714285714285714,0.5625,0.5526315789473685,0.55,0.5454545454545454,0.5454545454545454,0.5434782608695652,0.5365853658536586,0.5357142857142857,0.5333333333333333,0.5333333333333333,0.5294117647058824,0.5161290322580645,0.5142857142857142,0.5106382978723404,0.5,0.4878048780487805,0.4838709677419355,0.48,0.4736842105263158,0.4736842105263158,0.4736842105263158,0.4705882352941176,0.46875,0.4651162790697674,0.4615384615384616,0.4615384615384616,0.4615384615384616,0.4545454545454545,0.4545454545454545,0.4545454545454545,0.4482758620689655,0.4444444444444444,0.4242424242424243,0.4242424242424243,0.4210526315789473,0.4210526315789473,0.4117647058823529,0.4117647058823529,0.40625,0.4047619047619048,0.4,0.3928571428571428,0.3888888888888889,0.3846153846153846,0.3809523809523809,0.3809523809523809,0.3793103448275862,0.3636363636363636,0.3529411764705883,0.3529411764705883,0.35,0.35,0.325,0.3214285714285715,0.3214285714285715,0.3125,0.3125,0.3076923076923077,0.3043478260869565,0.2941176470588235,0.2941176470588235,0.2941176470588235,0.2857142857142857,0.2631578947368421,0.2592592592592592,0.2307692307692308,0.2272727272727273,0.2,0.1904761904761905,0.1666666666666667,0.16]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>Player<\\/th>\\n      <th>n<\\/th>\\n      <th>wins<\\/th>\\n      <th>loses<\\/th>\\n      <th>p<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"columnDefs\":[{\"className\":\"dt-right\",\"targets\":[2,3,4,5]},{\"orderable\":false,\"targets\":0},{\"name\":\" \",\"targets\":0},{\"name\":\"Player\",\"targets\":1},{\"name\":\"n\",\"targets\":2},{\"name\":\"wins\",\"targets\":3},{\"name\":\"loses\",\"targets\":4},{\"name\":\"p\",\"targets\":5}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false,\"orderCellsTop\":true}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\nEverybody now has at least 1 win and 1 loss. \n\nCheck graph to make sure it is connected. \n\n\n::: {.cell}\n\n```{.r .cell-code}\np <- simpleNetwork(tennis_filtered, \n                   height=\"100px\", width=\"100px\",        \n        Source = \"Winner\",               \n        Target = \"Loser\",            \n        linkDistance = 10,          # distance between node. Increase this value to have more space between nodes\n        charge = -900,                # numeric value indicating either the strength of the node repulsion (negative value) or attraction (positive value)\n        fontSize = 14,               # size of the node names\n        fontFamily = \"serif\",       # font og node names\n        linkColour = \"#666\",        # colour of edges, MUST be a common colour for the whole graph\n        nodeColour = \"#69b3a2\",     # colour of nodes, MUST be a common colour for the whole graph\n        opacity = 0.9,              # opacity of nodes. 0=transparent. 1=no transparency\n        zoom = T                    # Can you zoom on the figure?\n        )\n\np\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"forceNetwork html-widget html-fill-item\" id=\"htmlwidget-8dd9e78e0a74204af818\" style=\"width:100%;height:464px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-8dd9e78e0a74204af818\">{\"x\":{\"links\":{\"source\":[30,27,84,1,85,68,27,37,2,1,37,1,27,23,1,23,76,33,65,64,39,34,79,76,64,47,77,79,55,77,55,55,13,36,82,62,60,62,62,86,37,9,7,30,40,18,6,30,15,30,7,30,22,8,59,46,39,69,5,27,64,43,34,31,8,5,43,59,39,5,8,39,5,39,39,53,14,79,77,50,4,63,34,31,8,59,7,6,85,64,33,55,57,81,83,46,89,66,84,37,56,73,86,30,47,42,64,50,69,5,2,7,39,65,22,73,43,27,32,87,47,84,25,86,46,5,2,50,69,39,14,47,73,65,83,32,25,55,39,14,50,73,47,55,83,14,39,47,55,39,47,47,11,89,24,82,88,76,82,89,76,40,89,86,76,86,86,78,23,10,3,50,48,39,79,62,50,8,62,79,8,8,8,72,60,27,9,48,43,45,8,23,71,45,73,43,8,23,25,31,73,31,25,43,25,43,43,57,80,78,0,80,57,78,78,80,78,27,88,15,37,77,46,28,30,60,67,87,11,72,19,39,37,30,27,60,73,72,46,11,44,39,37,25,27,72,55,73,7,27,39,7,73,39,7,7,58,79,12,69,33,3,1,30,88,3,1,82,79,30,1,82,30,82,40,33,80,87,35,1,30,21,71,16,44,0,59,78,84,76,11,80,33,48,21,5,81,35,25,43,83,8,73,31,62,10,77,34,84,55,14,7,0,47,25,81,80,8,46,73,5,34,55,62,7,47,46,1,80,73,55,7,31,1,73,7,31,1,31,1,59,2,67,80,49,86,42,53,82,37,1,64,28,33,39,70,19,5,79,34,76,43,27,80,37,1,84,85,65,81,31,83,41,69,59,26,55,15,82,81,19,39,5,27,8,34,1,82,59,25,80,84,55,41,5,39,34,27,25,81,55,80,34,5,25,55,5,55,5,76,35,42,69,51,58,62,76,63,85,32,42,63,58,85,32,69,42,85,32,58,85,32,32,50,46,31,46,31,3,3,46,38,26,36,17,26,74,36,26,56,26,74,26,42,61,71,36,44,80,35,71,20,61,80,44,36,71,42,20,80,42,42,29,65,54,66,27,34,50,65,79,47,34,8,31,3,39,47,8,34,39,34,39,81,51,11,57,45,75,38,75,45,71,52,71,45,75,75,89,78,53,27,33,76,43,10,53,78,76,33,63,33,63,63,5,38,48,65,3,64,59,19,39,8,37,7,79,88,44,13,49,42,55,69,25,12,72,31,35,15,33,8,65,69,59,39,5,37,7,25,47,35,88,19,79,42,25,8,47,5,7,42,69,39,25,7,69,8,25,8,8,67,59,33,46,83,76,84,32,3,29,14,15,63,72,23,80,7,44,12,5,55,3,84,44,8,12,33,46,72,29,30,80,39,63,44,3,33,8,47,55,80,63,8,55,33,63,33,55,55,89,13,36,89,89,59,89,59,81,53,58,70,86,62,86,19,17,86,62,86,86,57,42,80,35,44,68,73,69,37,36,8,5,26,43,53,72,14,0,54,70,27,58,45,3,9,81,25,67,73,69,26,42,80,79,37,30,0,47,2,67,74,5,6,7,54,58,9,25,42,65,80,46,69,79,33,25,32,67,74,2,30,5,80,33,69,5,32,25,33,80,2,5,5,80,5,20,36,77,78,60,10,0,18,0,61,60,60,61,60,8,60,11,41,11,41,79,11,79,19,19,20,27,33,55,42,23,48,47,11,5,84,71,48,42,56,5,59,84,71,42,5,23,5,23,5,76,78,7,30,43,70,19,31,15,82,43,30,65,2,30,7,65,31,30,7,30,20,53,0,33,63,54,43,49,59,80,48,89,27,21,85,7,70,26,55,8,15,43,87,33,53,62,31,26,48,25,0,85,28,15,31,55,25,0,62,28,31,8,55,31,55,55,26,63,73,86,42,24,25,12,36,57,59,76,85,3,27,87,67,78,71,43,5,31,7,2,72,39,60,73,3,27,55,24,86,25,85,42,14,26,5,69,81,71,39,72,33,40,73,87,55,86,45,42,25,39,43,60,83,71,33,73,60,71,87,45,83,33,25,83,73,71,25,83,25,56,61,66,52,17,17,17,17,19,52,52,65,17,75,75,72,63,29,79,14,73,88,79,62,63,88,88,62,88,74,77,30,51,53,27,51,22,51,11,43,86,7,30,23,85,48,29,72,67,87,0,3,41,60,74,79,50,30,86,55,34,7,73,25,48,0,1,47,38,83,74,30,55,73,1,25,83,47,30,1,83,1,1,59,36,63,62,74,53,38,86,0,3,88,79,34,11,32,27,82,29,30,84,63,25,53,62,73,79,55,34,27,47,38,32,69,5,63,84,55,47,38,32,30,5,38,30,32,38,32,32,52,15,67,54,57,22,45,64,12,17,22,52,67,40,81,9,67,40,22,81,40,22,40,28,42,53,33,44,0,17,64,78,45,84,63,87,32,15,54,60,47,14,50,34,85,43,4,13,62,73,28,30,17,45,86,54,65,81,47,34,33,87,43,1,59,7,48,8,85,55,42,5,83,33,81,32,73,7,43,1,79,23,81,33,83,73,79,7,73,83,7,1,83,1,1,78,68,78,16,12,36,16,53,61,53,59,60,42,30,44,76,55,88,62,55,73,76,42,44,55,42,55,52,9,67,30,87,70,24,87,24,70,30,30,50,32,27,79,16,43,22,16,50,31,43,47,50,47,50,47,20,40,10,4,45,82,40,18,0,45,40,45,40,45,4,13,49,56,78,78,78,26,86,14,52,62,19,69,28,60,38,27,42,36,2,53,58,43,30,39,62,25,38,61,69,60,42,73,30,5,8,36,55,61,73,5,62,42,60,86,39,5,62,39,60,62,60,62,7,88,8,26,48,30,44,47,25,59,84,54,86,73,0,69,31,76,11,43,32,50,1,8,67,0,73,7,5,29,39,30,47,26,60,88,11,1,5,39,8,73,85,47,29,1,5,8,85,47,5,47,47,54,35,15,66,23,78,44,79,0,8,54,0,37,44,8,48,54,0,48,48,19,53,28,36,59,82,36,53,28,36,53,20,13,58,54,23,66,58,9,48,23,61,9,23,48,23,48,65,45,26,86,36,44,50,7,18,45,36,44,44,7,45,50,7,50,7,62,8,88,43,86,30,32,45,8,45,42,62,8,62,62,47,5,73,25,8,7,73,55,5,7,73,55,73,5,5],\"target\":[42,26,3,4,66,18,58,30,71,85,2,84,68,37,27,1,67,69,21,57,14,39,8,33,73,65,34,64,76,47,79,77,49,50,28,0,13,82,60,66,4,87,12,19,63,37,9,28,49,18,86,15,76,52,21,72,62,0,48,14,29,67,58,22,46,25,34,69,27,43,59,31,8,64,5,13,23,44,0,58,28,48,68,26,60,71,67,54,78,18,76,45,49,17,41,88,21,3,12,35,9,24,70,36,40,80,34,8,4,82,77,59,6,1,74,37,20,66,57,56,89,15,30,72,33,63,62,64,42,7,19,27,87,81,86,43,84,22,2,31,69,32,65,46,25,50,5,73,83,14,55,39,19,4,68,9,6,35,87,11,88,82,24,46,89,40,76,18,63,67,20,15,44,3,36,78,48,10,0,39,50,62,79,28,26,64,65,12,67,70,22,76,9,27,48,56,72,60,77,34,45,71,23,8,73,31,25,54,9,74,49,6,13,35,0,57,80,65,76,4,52,59,86,79,12,23,42,34,48,71,50,67,8,29,64,15,28,87,88,19,47,11,30,77,31,44,60,46,62,55,37,25,72,27,73,39,63,16,21,49,66,14,75,53,4,41,12,58,33,3,88,79,1,30,42,49,66,37,67,6,82,86,24,28,88,53,4,60,54,15,19,29,27,87,12,41,52,64,71,2,3,40,30,59,76,79,51,58,39,16,18,78,85,44,35,43,48,33,83,21,11,65,10,77,0,14,8,81,25,5,34,47,62,46,80,55,84,73,7,31,18,54,88,71,20,0,87,66,44,21,6,24,56,51,63,32,3,86,68,2,62,49,60,48,50,30,72,64,67,33,45,53,22,28,7,16,42,12,73,83,23,79,70,47,37,76,31,14,65,26,43,29,15,69,8,19,1,85,84,82,59,41,27,39,81,80,34,25,55,40,56,2,68,65,30,35,89,54,66,41,51,8,62,12,48,76,7,63,69,14,42,58,85,9,20,45,44,18,50,31,3,0,72,75,78,13,37,53,36,38,17,56,74,89,67,37,63,86,76,57,13,12,49,38,35,4,61,44,36,71,20,80,43,48,68,77,81,19,23,66,29,27,50,7,54,55,65,79,31,3,8,47,34,20,54,14,65,74,0,12,38,11,51,81,67,52,71,45,59,49,24,21,82,17,18,89,26,10,53,27,43,76,78,33,21,62,50,18,29,34,6,27,30,67,23,78,81,82,71,32,73,46,86,26,20,76,63,77,87,85,60,48,12,3,49,44,14,72,38,33,68,55,15,13,56,31,37,65,64,59,35,79,88,19,5,47,42,39,7,69,25,81,77,60,88,53,89,43,26,87,6,85,62,50,86,27,71,65,19,48,37,76,73,83,7,2,23,69,14,15,67,32,25,59,34,5,46,84,72,12,30,29,39,47,3,80,44,8,63,33,16,18,0,76,36,13,67,89,11,40,41,51,49,66,70,53,81,17,58,62,19,31,28,82,52,17,78,84,16,15,85,49,51,64,89,59,86,41,12,60,71,24,18,34,48,20,88,76,61,35,68,11,44,57,53,8,1,70,3,62,63,81,14,45,66,27,29,19,40,55,43,72,73,26,7,37,77,9,47,58,6,83,54,65,79,46,30,67,74,69,42,25,32,2,33,80,37,28,56,82,45,17,43,77,10,78,26,0,18,36,61,8,87,52,68,76,44,63,41,11,79,73,62,34,12,0,86,74,63,77,79,64,27,33,20,55,11,47,81,56,48,84,59,71,42,23,58,67,53,18,54,88,3,10,68,78,70,28,76,15,43,2,82,19,65,31,7,67,64,76,86,51,29,58,40,14,88,12,72,22,24,18,36,30,71,20,59,73,80,21,63,77,89,70,49,69,27,7,54,33,87,53,43,26,48,85,15,25,62,0,28,8,31,37,52,21,22,11,74,64,51,10,75,47,29,68,15,48,19,0,38,77,17,88,41,50,13,70,28,79,20,76,18,58,59,30,12,36,57,65,32,78,82,89,66,44,49,67,2,63,85,27,24,34,14,3,40,81,7,23,8,69,42,5,43,86,55,72,39,87,60,45,33,73,71,83,10,37,6,19,12,70,52,15,56,48,61,57,68,21,8,40,0,12,16,87,29,14,3,72,73,2,63,79,62,28,82,11,67,69,18,74,53,22,44,64,33,57,27,26,59,19,31,84,14,65,16,22,88,63,76,32,62,5,3,60,72,23,67,11,50,87,29,41,79,43,85,86,34,7,8,38,0,74,73,55,47,30,83,48,52,22,42,19,33,65,85,72,7,37,67,31,28,46,81,58,71,23,8,39,0,36,88,43,3,82,74,11,64,86,29,59,34,62,79,53,27,69,25,73,63,55,47,84,5,30,38,36,35,82,87,78,20,37,26,66,24,54,71,57,64,17,12,52,45,15,9,67,81,22,19,89,58,29,31,70,21,11,37,61,88,22,24,16,51,12,46,9,26,49,68,82,75,72,67,3,84,64,66,44,27,53,39,74,78,40,76,20,0,56,18,62,15,60,50,14,28,65,63,45,87,17,30,86,34,54,85,59,8,5,55,42,32,23,47,33,81,79,43,73,7,83,10,13,18,68,78,66,36,40,24,61,89,31,17,15,19,8,26,60,48,30,59,88,62,73,76,44,42,28,68,61,66,35,52,67,54,87,24,9,70,86,29,46,19,44,27,69,79,8,32,22,59,16,43,31,50,41,6,51,48,78,10,57,20,56,4,18,82,0,40,18,10,4,37,49,56,13,51,76,84,11,64,29,87,79,35,59,85,44,0,70,22,31,67,50,26,14,71,27,28,82,58,53,46,43,19,52,7,2,25,38,30,8,36,81,55,69,42,61,86,73,5,39,60,27,58,79,23,55,46,14,51,53,9,71,75,19,65,52,40,87,81,2,42,45,36,64,86,48,25,82,84,59,62,44,50,54,31,76,69,32,43,88,7,26,30,67,60,0,11,39,73,29,1,8,85,5,75,9,71,17,20,10,67,26,56,16,23,66,50,79,78,15,37,44,61,0,57,84,11,76,70,19,88,82,59,86,28,75,49,17,22,16,37,56,41,43,13,66,20,58,9,61,23,64,38,67,29,28,59,63,26,86,79,73,65,8,18,0,36,44,45,50,63,79,32,63,79,60,42,60,86,30,88,43,88,45,8,39,7,55,1,5,39,25,1,39,8,30,25,7,55,73],\"value\":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],\"colour\":[\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\",\"#666\"]},\"nodes\":{\"name\":[\"Alexandrova E.\",\"Andreescu B.\",\"Anisimova A.\",\"Azarenka V.\",\"Babos T.\",\"Barty A.\",\"Begu I.\",\"Bencic B.\",\"Bertens K.\",\"Blinkova A.\",\"Bonaventure Y.\",\"Brady J.\",\"Buzarnescu M.\",\"Cirstea S.\",\"Collins D.\",\"Cornet A.\",\"Doi M.\",\"Ferro F.\",\"Flipkens K.\",\"Garcia C.\",\"Gasparyan M.\",\"Gavrilova D.\",\"Giorgi C.\",\"Goerges J.\",\"Golubic V.\",\"Halep S.\",\"Hercog P.\",\"Hsieh S.W.\",\"Jabeur O.\",\"Kasatkina D.\",\"Kenin S.\",\"Kerber A.\",\"Keys M.\",\"Konta J.\",\"Kontaveit A.\",\"Kozlova K.\",\"Kudermetova V.\",\"Kuzmova V.\",\"Kuznetsova S.\",\"Kvitova P.\",\"Linette M.\",\"Maria T.\",\"Martic P.\",\"Mertens E.\",\"Mladenovic K.\",\"Muchova K.\",\"Muguruza G.\",\"Osaka N.\",\"Ostapenko J.\",\"Parmentier P.\",\"Pavlyuchenkova A.\",\"Pegula J.\",\"Pera B.\",\"Peterson R.\",\"Petkovic A.\",\"Pliskova Ka.\",\"Pliskova Kr.\",\"Potapova A.\",\"Puig M.\",\"Putintseva Y.\",\"Riske A.\",\"Rybakina E.\",\"Sabalenka A.\",\"Sakkari M.\",\"Sasnovich A.\",\"Sevastova A.\",\"Siegemund L.\",\"Siniakova K.\",\"Sorribes Tormo S.\",\"Stephens S.\",\"Stosur S.\",\"Strycova B.\",\"Suarez Navarro C.\",\"Svitolina E.\",\"Swiatek I.\",\"Teichmann J.\",\"Tomljanovic A.\",\"Tsurenko L.\",\"Van Uytvanck A.\",\"Vekic D.\",\"Vondrousova M.\",\"Wang Q.\",\"Wang Yaf.\",\"Williams S.\",\"Williams V.\",\"Wozniacki C.\",\"Yastremska D.\",\"Zhang S.\",\"Zheng S.\",\"Zidansek T.\"],\"group\":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],\"nodesize\":[8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8]},\"options\":{\"NodeID\":\"name\",\"Group\":\"group\",\"colourScale\":\"d3.scaleOrdinal(['#69b3a2'])\",\"fontSize\":14,\"fontFamily\":\"serif\",\"clickTextSize\":35,\"linkDistance\":10,\"linkWidth\":\"'1.5px'.toString()\",\"charge\":-900,\"opacity\":0.9,\"zoom\":true,\"legend\":false,\"arrows\":false,\"nodesize\":true,\"radiusCalculation\":\"d.nodesize\",\"bounded\":false,\"opacityNoHover\":1,\"clickAction\":null}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\nThis graph looks complete and well connected. \nPerhaps this is unsurprising because the top tennis players play a lot of games\nagainst each other over the course of a year. \n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Convert team names into factors\nplayers <- data.frame(\n  names = c(tennis_filtered$Winner, tennis_filtered$Loser) |>\n    unique() |>\n    sort() |>\n    factor()\n) \n\n\ntennis_filtered_factored <- tennis_filtered |>\n  mutate(\n    Winner = factor(Winner, levels = players$names),\n    Loser  = factor(Loser,  levels = players$names)\n  ) \n\nX_t <- tennis_filtered_factored |>\n  construct_model_matrix(\"Winner\", \"Loser\")\n```\n:::\n\n\nCheck the model matrix\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndim(X_t)                    # n_games x n_teams\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 1414   90\n```\n\n\n:::\n\n```{.r .cell-code}\ntable(X_t)                  # make sure all entries are -1, 0, 1\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nX_t\n    -1      0      1 \n  1414 124432   1414 \n```\n\n\n:::\n\n```{.r .cell-code}\nall(rowSums(X_t) == 0)      # each row has one winner and one loser\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] TRUE\n```\n\n\n:::\n\n```{.r .cell-code}\nall(rowSums(abs(X_t)) == 2) # ^\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] TRUE\n```\n\n\n:::\n\n```{.r .cell-code}\ntable(colSums(X_t))         # for each player, number of wins - number of loses\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n-17 -14 -13 -12 -10  -9  -8  -7  -6  -5  -4  -3  -2  -1   0   1   2   3   4   5 \n  1   1   2   2   4   3   1   5  12   5   1   6   8   5   1   3   4   4   3   1 \n  7   9  10  13  14  15  16  17  18  19  20  26  34 \n  2   2   1   1   1   1   1   1   2   2   2   1   1 \n```\n\n\n:::\n:::\n\n\nFinally, we can fit our logistic regression model. \nFor these data, we do not have a binary column that indicates the winner.\nInstead, we have a column that indicates the winner by name. \nThus, we will need to create a binary column that indicates the first\ncolumn (named Winner) is the winner. \n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Fit logistic regression model\n# since columns are Winner/Loser the result should always be TRUE,\n# i.e. the first column won\nm <- glm(rep(TRUE, nrow(X_t)) ~ X_t - 1, # no home field\n         family = binomial(link = \"logit\")) \n\ntail(coef(m))         # includes last team as NA\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n     X_t85      X_t86      X_t87      X_t88      X_t89      X_t90 \n 0.9837438  0.3987670  0.6788688 -0.2555386  0.1827746         NA \n```\n\n\n:::\n\n```{.r .cell-code}\ntail(summary(m)$coef) # notice only 89 rows, but there are 90 teams\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n        Estimate Std. Error    z value    Pr(>|z|)\nX_t84  1.8207497  0.6563103  2.7742211 0.005533406\nX_t85  0.9837438  0.6277945  1.5669838 0.117118482\nX_t86  0.3987670  0.6202366  0.6429272 0.520271365\nX_t87  0.6788688  0.5733442  1.1840511 0.236392836\nX_t88 -0.2555386  0.6176878 -0.4137019 0.679092435\nX_t89  0.1827746  0.6000472  0.3046003 0.760670565\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplayers$strength <- c(coef(m)[-length(coef(m))], 0)\n\nplayer_strength <- players |>\n  mutate(\n    names = factor(names, \n                     levels = players$names[order(players$strength)]),\n    strength = strength - mean(strength)\n  ) |>\n  arrange(desc(strength))\n\nggplot(player_strength,\n       aes(\n         x = strength,\n         y = names\n       )) +\n  geom_bar(stat = \"identity\") +\n  labs(\n    x = 'Strength',\n    y = 'Player',\n    title = \"2019 Women's Tennis Players\"\n  )\n```\n\n::: {.cell-output-display}\n![](07-win-loss_files/figure-html/tennis-strength-1.png){width=672}\n:::\n:::\n\nTo calculate the probability that one player beats another we can calculate the\ndifference in their strengths and then calculate the probability. \n\n\n::: {.cell}\n\n```{.r .cell-code}\ndiff <- players$strength[players$names == \"Barty A.\"] -\n  players$strength[players$names == \"Halep S.\"]\n\nexpit(diff)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.642461\n```\n\n\n:::\n:::\n\n\n\n\n\n\n## R packages\n\nThe models discussed in this chapter are often referred to as \nBradley-Terry models after the \n[1952 Biometrika article](https://doi.org/10.2307/2334029) \nwritten by Ralph Bradley and Milton Terry [@bradley1952rank]. \n\n- [BradleyTerry2](https://cran.r-project.org/web/packages/BradleyTerry2/index.html)\n- [BradleyTerryScalable](https://github.com/EllaKaye/BradleyTerryScalable)\n- [bpcs](https://davidissamattos.github.io/bpcs/)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbt_m <- BradleyTerry2::BTm(player1 = Winner,\n            player2 = Loser,\n            data = tennis_filtered_factored)\n\nsummary(bt_m)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nBradleyTerry2::BTm(player1 = Winner, player2 = Loser, data = tennis_filtered_factored)\n\nCoefficients:\n                    Estimate Std. Error z value Pr(>|z|)    \n..Andreescu B.       1.94999    0.54629   3.570 0.000358 ***\n..Anisimova A.       0.19720    0.57777   0.341 0.732870    \n..Azarenka V.        0.29196    0.51307   0.569 0.569326    \n..Babos T.          -1.12184    0.72819  -1.541 0.123417    \n..Barty A.           2.08396    0.48064   4.336 1.45e-05 ***\n..Begu I.           -0.99389    0.78898  -1.260 0.207775    \n..Bencic B.          1.40985    0.44982   3.134 0.001723 ** \n..Bertens K.         1.02180    0.43455   2.351 0.018704 *  \n..Blinkova A.       -0.72067    0.59866  -1.204 0.228665    \n..Bonaventure Y.    -0.92131    0.65720  -1.402 0.160954    \n..Brady J.           0.01215    0.53577   0.023 0.981914    \n..Buzarnescu M.     -1.12972    0.58067  -1.946 0.051709 .  \n..Cirstea S.        -1.05997    0.66069  -1.604 0.108639    \n..Collins D.        -0.20407    0.53427  -0.382 0.702483    \n..Cornet A.         -0.47105    0.54205  -0.869 0.384842    \n..Doi M.            -0.56444    0.66026  -0.855 0.392617    \n..Ferro F.          -0.45868    0.57552  -0.797 0.425463    \n..Flipkens K.       -1.78898    0.67342  -2.657 0.007894 ** \n..Garcia C.         -0.48776    0.51046  -0.956 0.339307    \n..Gasparyan M.      -0.82213    0.60911  -1.350 0.177107    \n..Gavrilova D.      -1.56190    0.76995  -2.029 0.042501 *  \n..Giorgi C.         -0.41830    0.57768  -0.724 0.468999    \n..Goerges J.         0.42035    0.51729   0.813 0.416448    \n..Golubic V.        -1.23970    0.66332  -1.869 0.061633 .  \n..Halep S.           1.49790    0.46984   3.188 0.001432 ** \n..Hercog P.          0.16492    0.50337   0.328 0.743189    \n..Hsieh S.W.         0.60157    0.47262   1.273 0.203071    \n..Jabeur O.         -0.59852    0.54908  -1.090 0.275691    \n..Kasatkina D.      -0.52272    0.55984  -0.934 0.350460    \n..Kenin S.           1.32696    0.45803   2.897 0.003766 ** \n..Kerber A.          0.54516    0.47877   1.139 0.254838    \n..Keys M.            1.09317    0.52465   2.084 0.037194 *  \n..Konta J.           1.06582    0.48112   2.215 0.026742 *  \n..Kontaveit A.       0.56882    0.51163   1.112 0.266233    \n..Kozlova K.        -0.28802    0.60566  -0.476 0.634394    \n..Kudermetova V.     0.41372    0.49361   0.838 0.401941    \n..Kuzmova V.        -0.25375    0.51282  -0.495 0.620735    \n..Kuznetsova S.      0.84488    0.58250   1.450 0.146940    \n..Kvitova P.         1.42855    0.47270   3.022 0.002510 ** \n..Linette M.         0.15431    0.54488   0.283 0.777028    \n..Maria T.          -0.65721    0.66608  -0.987 0.323798    \n..Martic P.          1.15813    0.47007   2.464 0.013751 *  \n..Mertens E.         0.69051    0.46513   1.485 0.137668    \n..Mladenovic K.      0.36512    0.48121   0.759 0.448002    \n..Muchova K.         0.89722    0.50180   1.788 0.073777 .  \n..Muguruza G.        0.71191    0.53933   1.320 0.186840    \n..Osaka N.           1.45030    0.49019   2.959 0.003090 ** \n..Ostapenko J.       0.13926    0.47527   0.293 0.769518    \n..Parmentier P.     -1.54947    0.67147  -2.308 0.021022 *  \n..Pavlyuchenkova A.  0.43197    0.49363   0.875 0.381527    \n..Pegula J.         -0.97273    0.65934  -1.475 0.140131    \n..Pera B.           -0.50889    0.56777  -0.896 0.370097    \n..Peterson R.        0.45510    0.50030   0.910 0.363009    \n..Petkovic A.       -0.08877    0.54869  -0.162 0.871476    \n..Pliskova Ka.       1.65656    0.45816   3.616 0.000300 ***\n..Pliskova Kr.      -1.16075    0.62043  -1.871 0.061361 .  \n..Potapova A.       -0.39444    0.62945  -0.627 0.530893    \n..Puig M.           -0.30258    0.54970  -0.550 0.582019    \n..Putintseva Y.      0.18036    0.48757   0.370 0.711449    \n..Riske A.           0.85391    0.47894   1.783 0.074600 .  \n..Rybakina E.       -0.34392    0.60788  -0.566 0.571551    \n..Sabalenka A.       0.73106    0.45005   1.624 0.104292    \n..Sakkari M.         0.40174    0.47661   0.843 0.399279    \n..Sasnovich A.      -0.46474    0.55459  -0.838 0.402042    \n..Sevastova A.      -0.15540    0.51929  -0.299 0.764750    \n..Siegemund L.      -1.09032    0.62575  -1.742 0.081432 .  \n..Siniakova K.      -0.68916    0.48663  -1.416 0.156726    \n..Sorribes Tormo S. -1.88910    0.75431  -2.504 0.012265 *  \n..Stephens S.        0.47728    0.49544   0.963 0.335374    \n..Stosur S.         -0.41160    0.58489  -0.704 0.481605    \n..Strycova B.       -0.16883    0.51471  -0.328 0.742901    \n..Suarez Navarro C.  0.02552    0.52669   0.048 0.961354    \n..Svitolina E.       1.27096    0.45042   2.822 0.004777 ** \n..Swiatek I.        -0.40410    0.60059  -0.673 0.501049    \n..Teichmann J.       0.03009    0.68384   0.044 0.964907    \n..Tomljanovic A.    -0.14125    0.47160  -0.300 0.764542    \n..Tsurenko L.       -0.47061    0.60977  -0.772 0.440240    \n..Van Uytvanck A.    0.02082    0.51317   0.041 0.967637    \n..Vekic D.           0.42578    0.46433   0.917 0.359153    \n..Vondrousova M.     1.57059    0.55554   2.827 0.004696 ** \n..Wang Q.            0.15051    0.52042   0.289 0.772415    \n..Wang Yaf.         -0.11610    0.51263  -0.226 0.820828    \n..Williams S.        1.60163    0.56200   2.850 0.004374 ** \n..Williams V.        0.76463    0.53405   1.432 0.152215    \n..Wozniacki C.       0.17965    0.51690   0.348 0.728178    \n..Yastremska D.      0.45975    0.46352   0.992 0.321257    \n..Zhang S.          -0.47466    0.50839  -0.934 0.350491    \n..Zheng S.          -0.03634    0.50656  -0.072 0.942805    \n..Zidansek T.       -0.21912    0.57539  -0.381 0.703340    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for binomial family taken to be 1)\n\n    Null deviance: 1960.2  on 1414  degrees of freedom\nResidual deviance: 1654.8  on 1325  degrees of freedom\nAIC: 1832.8\n\nNumber of Fisher Scoring iterations: 4\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nBradleyTerry2::BTabilities(bt_m) |> \n  datatable(\n    filter = \"top\"\n  )\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"datatables html-widget html-fill-item\" id=\"htmlwidget-13831d916c549418bd0b\" style=\"width:100%;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-13831d916c549418bd0b\">{\"x\":{\"filter\":\"top\",\"vertical\":false,\"filterHTML\":\"<tr>\\n  <td><\\/td>\\n  <td data-type=\\\"number\\\" style=\\\"vertical-align: top;\\\">\\n    <div class=\\\"form-group has-feedback\\\" style=\\\"margin-bottom: auto;\\\">\\n      <input type=\\\"search\\\" placeholder=\\\"All\\\" class=\\\"form-control\\\" style=\\\"width: 100%;\\\"/>\\n      <span class=\\\"glyphicon glyphicon-remove-circle form-control-feedback\\\"><\\/span>\\n    <\\/div>\\n    <div style=\\\"display: none;position: absolute;width: 200px;opacity: 1\\\">\\n      <div data-min=\\\"-1.8890973561265\\\" data-max=\\\"2.0839570241776\\\" data-scale=\\\"15\\\"><\\/div>\\n      <span style=\\\"float: left;\\\"><\\/span>\\n      <span style=\\\"float: right;\\\"><\\/span>\\n    <\\/div>\\n  <\\/td>\\n  <td data-type=\\\"number\\\" style=\\\"vertical-align: top;\\\">\\n    <div class=\\\"form-group has-feedback\\\" style=\\\"margin-bottom: auto;\\\">\\n      <input type=\\\"search\\\" placeholder=\\\"All\\\" class=\\\"form-control\\\" style=\\\"width: 100%;\\\"/>\\n      <span class=\\\"glyphicon glyphicon-remove-circle form-control-feedback\\\"><\\/span>\\n    <\\/div>\\n    <div style=\\\"display: none;position: absolute;width: 200px;opacity: 1\\\">\\n      <div data-min=\\\"0\\\" data-max=\\\"0.788983318153575\\\" data-scale=\\\"15\\\"><\\/div>\\n      <span style=\\\"float: left;\\\"><\\/span>\\n      <span style=\\\"float: right;\\\"><\\/span>\\n    <\\/div>\\n  <\\/td>\\n<\\/tr>\",\"data\":[[\"Alexandrova E.\",\"Andreescu B.\",\"Anisimova A.\",\"Azarenka V.\",\"Babos T.\",\"Barty A.\",\"Begu I.\",\"Bencic B.\",\"Bertens K.\",\"Blinkova A.\",\"Bonaventure Y.\",\"Brady J.\",\"Buzarnescu M.\",\"Cirstea S.\",\"Collins D.\",\"Cornet A.\",\"Doi M.\",\"Ferro F.\",\"Flipkens K.\",\"Garcia C.\",\"Gasparyan M.\",\"Gavrilova D.\",\"Giorgi C.\",\"Goerges J.\",\"Golubic V.\",\"Halep S.\",\"Hercog P.\",\"Hsieh S.W.\",\"Jabeur O.\",\"Kasatkina D.\",\"Kenin S.\",\"Kerber A.\",\"Keys M.\",\"Konta J.\",\"Kontaveit A.\",\"Kozlova K.\",\"Kudermetova V.\",\"Kuzmova V.\",\"Kuznetsova S.\",\"Kvitova P.\",\"Linette M.\",\"Maria T.\",\"Martic P.\",\"Mertens E.\",\"Mladenovic K.\",\"Muchova K.\",\"Muguruza G.\",\"Osaka N.\",\"Ostapenko J.\",\"Parmentier P.\",\"Pavlyuchenkova A.\",\"Pegula J.\",\"Pera B.\",\"Peterson R.\",\"Petkovic A.\",\"Pliskova Ka.\",\"Pliskova Kr.\",\"Potapova A.\",\"Puig M.\",\"Putintseva Y.\",\"Riske A.\",\"Rybakina E.\",\"Sabalenka A.\",\"Sakkari M.\",\"Sasnovich A.\",\"Sevastova A.\",\"Siegemund L.\",\"Siniakova K.\",\"Sorribes Tormo S.\",\"Stephens S.\",\"Stosur S.\",\"Strycova B.\",\"Suarez Navarro C.\",\"Svitolina E.\",\"Swiatek I.\",\"Teichmann J.\",\"Tomljanovic A.\",\"Tsurenko L.\",\"Van Uytvanck A.\",\"Vekic D.\",\"Vondrousova M.\",\"Wang Q.\",\"Wang Yaf.\",\"Williams S.\",\"Williams V.\",\"Wozniacki C.\",\"Yastremska D.\",\"Zhang S.\",\"Zheng S.\",\"Zidansek T.\"],[0,1.949990718201484,0.1971997853000585,0.2919606292804025,-1.121842486795572,2.083957024177602,-0.99388791333709,1.409851108813431,1.021800519072889,-0.7206746834255565,-0.9213088535531906,0.01214595671828633,-1.129720113200175,-1.0599693542449,-0.2040744288087462,-0.4710468030905767,-0.5644430228093354,-0.4586752812667259,-1.788984801390572,-0.4877628773670417,-0.822127620400942,-1.56190195166567,-0.4182995821536097,0.4203475373380376,-1.239704640831011,1.497895434608031,0.1649211036131674,0.6015690483479529,-0.5985200464897159,-0.5227225229573778,1.326963025818226,0.5451603266705625,1.093167370247665,1.065818263119661,0.5688228687103928,-0.2880237396324721,0.4137229289744475,-0.2537478004003929,0.8448775214453651,1.428548210529517,0.1543062636209103,-0.6572108959300265,1.158125433804608,0.6905068226761436,0.3651206379775058,0.8972213424831332,0.7119113064142352,1.45029996945166,0.1392569218498921,-1.549470002473736,0.4319717950792819,-0.9727296893512155,-0.5088895799968178,0.455096365942629,-0.08876960267184116,1.656557841176044,-1.160751940117672,-0.3944382159962126,-0.3025761921101867,0.1803558586604593,0.8539131911908735,-0.3439187373688081,0.7310550521125505,0.4017399771546425,-0.4647389058925852,-0.1553962401327986,-1.090324064876378,-0.6891552517987485,-1.889097356126503,0.4772835539928253,-0.4115992319250923,-0.1688309753245882,0.02552067275068911,1.270956330839099,-0.4041008552699747,0.03008635519513837,-0.1412543780244364,-0.4706145459246436,0.02082075105438738,0.4257800646181279,1.57059370932387,0.1505142581480279,-0.1161000455019377,1.601632238616111,0.7646262671633716,0.1796494576303022,0.4597512748542924,-0.4746561343902489,-0.03634292615184746,-0.2191175041168893],[0,0.5462861946949873,0.5777737246353457,0.5130722115499372,0.7281917873606328,0.4806369273499741,0.7889833181535744,0.449820437666017,0.4345545076279615,0.5986634904517625,0.6571996228667429,0.5357745581270461,0.580670236034296,0.6606893789746751,0.5342662292784784,0.5420502770427815,0.6602588998627275,0.5755173426049081,0.6734202207837978,0.5104607709436828,0.6091116565889679,0.7699462650328189,0.5776753915254018,0.5172883079319023,0.6633243791206616,0.4698426192220643,0.5033710273419271,0.4726156231979863,0.5490756496028213,0.5598416305680376,0.4580250664386908,0.4787668683877175,0.5246467592950518,0.4811236109614117,0.5116329389276735,0.6056621074102374,0.4936091801598995,0.5128192270653064,0.5825035482955297,0.4727026404929714,0.5448791375363777,0.6660815175491291,0.4700745382132462,0.4651345865383763,0.4812131467490502,0.5018025205021028,0.5393322932721502,0.4901899318442322,0.4752714092881251,0.671466790129186,0.4936336341793012,0.6593413195956997,0.5677719738730811,0.5002998248072481,0.5486911819154408,0.4581635019962297,0.6204291881121478,0.62944551647851,0.5497007026160597,0.487565668244584,0.4789415467094283,0.607878244564758,0.4500479048625189,0.4766108310542096,0.5545943138701604,0.5192869891335127,0.6257467151149764,0.4866332368711492,0.7543064116390824,0.4954438273388103,0.5848881658885783,0.5147063402793181,0.5266884747458219,0.4504213434265695,0.6005893044914066,0.6838350597285668,0.4716007453643778,0.6097716898734306,0.5131739935536231,0.4643280778621361,0.5555378221502072,0.5204182066187891,0.5126288180150975,0.5620007874960238,0.5340497132528147,0.5169030988682626,0.4635154601808169,0.5083947282404306,0.506558358407595,0.5753899276713438]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>ability<\\/th>\\n      <th>s.e.<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"columnDefs\":[{\"className\":\"dt-right\",\"targets\":[1,2]},{\"orderable\":false,\"targets\":0},{\"name\":\" \",\"targets\":0},{\"name\":\"ability\",\"targets\":1},{\"name\":\"s.e.\",\"targets\":2}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false,\"orderCellsTop\":true}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nd <- BradleyTerry2::BTabilities(bt_m) |> as.data.frame()\nd$name <- rownames(d)\n\n\nggplot(d,\n       aes(\n         x = ability,\n         y = name\n       )) +\n  geom_bar(stat = \"identity\")\n```\n\n::: {.cell-output-display}\n![](07-win-loss_files/figure-html/bt-abilities-plot-1.png){width=672}\n:::\n:::",
    "supporting": [
      "07-win-loss_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"site_libs/htmltools-fill-0.5.8.1/fill.css\" rel=\"stylesheet\" />\n<script src=\"site_libs/htmlwidgets-1.6.4/htmlwidgets.js\"></script>\n<script src=\"site_libs/d3-4.5.0/d3.min.js\"></script>\n<script src=\"site_libs/forceNetwork-binding-0.4/forceNetwork.js\"></script>\n<link href=\"site_libs/datatables-css-0.0.0/datatables-crosstalk.css\" rel=\"stylesheet\" />\n<script src=\"site_libs/datatables-binding-0.33/datatables.js\"></script>\n<script src=\"site_libs/jquery-3.6.0/jquery-3.6.0.min.js\"></script>\n<link href=\"site_libs/dt-core-1.13.6/css/jquery.dataTables.min.css\" rel=\"stylesheet\" />\n<link href=\"site_libs/dt-core-1.13.6/css/jquery.dataTables.extra.css\" rel=\"stylesheet\" />\n<script src=\"site_libs/dt-core-1.13.6/js/jquery.dataTables.min.js\"></script>\n<link href=\"site_libs/nouislider-7.0.10/jquery.nouislider.min.css\" rel=\"stylesheet\" />\n<script src=\"site_libs/nouislider-7.0.10/jquery.nouislider.min.js\"></script>\n<link href=\"site_libs/selectize-0.12.0/selectize.bootstrap3.css\" rel=\"stylesheet\" />\n<script src=\"site_libs/selectize-0.12.0/selectize.min.js\"></script>\n<link href=\"site_libs/crosstalk-1.2.1/css/crosstalk.min.css\" rel=\"stylesheet\" />\n<script src=\"site_libs/crosstalk-1.2.1/js/crosstalk.min.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}